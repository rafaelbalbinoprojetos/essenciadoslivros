Critical – All serverless endpoints are publicly callable with no authentication or plan validation, so anyone on the internet can burn your OpenAI quota or trigger payment flows just by hitting the URLs. See api/chat.js (lines 46-99), api/transcribe.js (lines 28-72), api/mercadopago/checkout.js (lines 19-101), and api/mercadopago/subscription.js (lines 19-109); none of them check for a Supabase session/JWT, referer, or even the user/plan sent by the client. Relying on the React UI (ProtectedRoute) is insufficient because these endpoints are deployed under /api/* and can be scripted directly.
High – api/chat.js uses the Supabase service key to grab the latest books/authors/collections for the entire project (api/chat.js (lines 19-43)) and injects that snapshot into every conversation (api/chat.js (lines 59-84)). There is no tenant or user filtering, so any signed-in user—and even unauthenticated callers because of the previous issue—can see other customers’ catalog data through the assistant.
High – Core catalog tables have no row-level security while the client exposes raw insert APIs to every logged-in user. src/info_tabelas.txt (lines 12-65) defines autores, livros, generos, and colecoes but only enables RLS for progresso_leitura, avaliacoes, and assinaturas (src/info_tabelas.txt (lines 126-162)). The UI routes (src/App.jsx (lines 18-24)) make /biblioteca/novo available to all authenticated users, and BookCreate calls createBook/createAuthor/createCollection on the public anon key (src/pages/BookCreate.jsx (lines 28-185), src/services/books.js (lines 1-42)). Any user (or anyone who steals the anon key) can therefore overwrite the global catalog.
Medium – Premium access to the assistant is enforced only in the component render (src/pages/Chatbot.jsx (lines 324-407)). The backend that actually spends tokens (api/chat.js (lines 46-99)) never checks the user’s plan, so changing hasPremiumAccess in devtools or calling /api/chat directly bypasses the paywall.
Next steps

Put proper authentication/authorization in every /api handler (e.g., verify Supabase JWTs, enforce plan/role checks server-side, and reject anonymous traffic).
Add RLS policies for livros/autores/generos/colecoes and restrict the create/edit endpoints to privileged roles or backend service functions.
Filter fetchLibrarySnapshot by the requesting user or workspace so the assistant never leaks other tenants’ data.